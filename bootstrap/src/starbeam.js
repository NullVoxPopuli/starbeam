import findWorkspaceDir from "@pnpm/find-workspace-dir";
import { dirname } from "path";
import { fileURLToPath } from "url";
import { Workspace } from "./compile.js";
const dir = dirname(fileURLToPath(import.meta.url));
const root = await findWorkspaceDir.default(dir);
if (root === undefined) {
    console.error(`Couldn't find workspace root from ${dir}`);
    process.exit(1);
}
const WORKSPACE = await Workspace.create(root, "@starbeam");
console.log({ root, packages: WORKSPACE.packages });
for (let pkg of WORKSPACE.packages) {
    await pkg.compile({ dryRun: true });
    process.exit(1);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhcmJlYW0uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzdGFyYmVhbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLGdCQUFnQixNQUFNLDBCQUEwQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLEtBQUssQ0FBQztBQUNwQyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBRXpDLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQ3BELE1BQU0sSUFBSSxHQUFHLE1BQU0sZ0JBQWdCLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBRWpELElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRTtJQUN0QixPQUFPLENBQUMsS0FBSyxDQUFDLHFDQUFxQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzFELE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7Q0FDakI7QUFJRCxNQUFNLFNBQVMsR0FBRyxNQUFNLFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0FBRTVELE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO0FBRXBELEtBQUssSUFBSSxHQUFHLElBQUksU0FBUyxDQUFDLFFBQVEsRUFBRTtJQUNsQyxNQUFNLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUNwQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0NBQ2pCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZpbmRXb3Jrc3BhY2VEaXIgZnJvbSBcIkBwbnBtL2ZpbmQtd29ya3NwYWNlLWRpclwiO1xuaW1wb3J0IHsgZGlybmFtZSB9IGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBmaWxlVVJMVG9QYXRoIH0gZnJvbSBcInVybFwiO1xuaW1wb3J0IHsgV29ya3NwYWNlIH0gZnJvbSBcIi4vY29tcGlsZS5qc1wiO1xuXG5jb25zdCBkaXIgPSBkaXJuYW1lKGZpbGVVUkxUb1BhdGgoaW1wb3J0Lm1ldGEudXJsKSk7XG5jb25zdCByb290ID0gYXdhaXQgZmluZFdvcmtzcGFjZURpci5kZWZhdWx0KGRpcik7XG5cbmlmIChyb290ID09PSB1bmRlZmluZWQpIHtcbiAgY29uc29sZS5lcnJvcihgQ291bGRuJ3QgZmluZCB3b3Jrc3BhY2Ugcm9vdCBmcm9tICR7ZGlyfWApO1xuICBwcm9jZXNzLmV4aXQoMSk7XG59XG5cbnR5cGUgU3RhcmJlYW1QYWNrYWdlPFAgZXh0ZW5kcyBzdHJpbmc+ID0gYEBzdGFyYmVhbS8ke1B9YDtcblxuY29uc3QgV09SS1NQQUNFID0gYXdhaXQgV29ya3NwYWNlLmNyZWF0ZShyb290LCBcIkBzdGFyYmVhbVwiKTtcblxuY29uc29sZS5sb2coeyByb290LCBwYWNrYWdlczogV09SS1NQQUNFLnBhY2thZ2VzIH0pO1xuXG5mb3IgKGxldCBwa2cgb2YgV09SS1NQQUNFLnBhY2thZ2VzKSB7XG4gIGF3YWl0IHBrZy5jb21waWxlKHsgZHJ5UnVuOiB0cnVlIH0pO1xuICBwcm9jZXNzLmV4aXQoMSk7XG59XG4iXX0=